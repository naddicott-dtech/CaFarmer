<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>California Climate Farmer</title>
    <link rel="stylesheet" href="style.css"> <!-- Link to CSS file -->
</head>
<body>
    <div class="container">
        <header>
            <h1>California Climate Farmer <span class="badge">Year <span id="year-display">1</span></span> <span class="badge">Season: <span id="season-display">Spring</span></span></h1>
            <div class="btn-group">
                <button id="pause-btn" class="btn">Pause</button>
                <!-- Dashboard button will be added here by JS -->
                <button id="help-btn" class="btn secondary">Help</button>
            </div>
        </header>

        <div class="main-content">
            <div class="farm-grid-container">

                <!-- Wrapper for Grid Layout -->
                <div class="grid-and-selectors-wrapper">
                    <!-- Row Selectors Placeholder (Buttons added by JS) -->
                    <div class="row-selectors"></div>
                    <!-- Column Selectors Placeholder (Buttons added by JS) -->
                    <div class="column-selectors"></div>
                    <!-- Canvas -->
                    <canvas id="farm-grid"></canvas>
                </div>
                <!-- End Wrapper -->

                <!-- Other UI Elements Relative to the Container -->
                <div class="overlay-controls">
                    <select id="overlay-select">
                        <option value="crop">Crop Type</option>
                        <option value="water">Water Status</option>
                        <option value="soil">Soil Health</option>
                        <option value="yield">Expected Yield</option>
                    </select>
                </div>
                <div class="grid-legend" id="grid-legend"></div>
                <div id="tooltip" class="tooltip"></div>
                <div id="cell-info" class="cell-info-panel">
                    <h2>Plot Information</h2>
                    <div id="cell-details"></div>
                    <div class="crop-selection">
                        <h3>Plant Crop</h3>
                        <div id="crop-options"></div>
                    </div>
                    <div class="cell-actions">
                        <button id="irrigate-btn" class="btn">Irrigate</button>
                        <button id="fertilize-btn" class="btn">Fertilize</button>
                        <button id="harvest-btn" class="btn">Harvest</button>
                        <button id="close-cell-info" class="btn secondary">Close</button>
                    </div>
                </div>
                <!-- Bulk Panel and Hotkey Info are siblings of the wrapper -->
                 <div id="bulk-action-panel" class="bulk-action-panel"></div>
                 <div class="hotkey-info"></div>

            </div>

            <div class="sidebar">
                <!-- Dashboard will be inserted here by JS if needed -->
                <div class="hud-panel">
                    <h2>Farm Status</h2>
                    <div class="stat"><span>Bank Balance:</span><span class="stat-value">$<span id="balance">100000</span></span></div>
                    <div class="stat"><span>Farm Value:</span><span class="stat-value">$<span id="farm-value">250000</span></span></div>
                    <div class="stat"><span>Farm Health:</span><span class="stat-value"><span id="farm-health">85</span>%</span></div>
                    <div class="stat"><span>Water Reserve:</span><span class="stat-value"><span id="water-reserve">75</span>%</span></div>
                    <div class="stat"><span>Date:</span><span class="stat-value" id="date-display">Spring, Year 1</span></div>
                    <div class="speed-control"><span>Speed:</span><input type="range" id="speed-slider" min="1" max="10" value="5"><span id="speed-value">5x</span></div>
                </div>

                <div class="control-panel">
                    <h2>Actions</h2>
                    <!-- Removed radio group as selection mode replaces it -->
                    <!-- <div class="radio-group"> ... </div> -->
                    <p>Click grid or use selectors. Hotkeys: (I)rrigate, (F)ertilize, (H)arvest, (M)ode, (R)epeat, (D)ashboard, (Esc)Clear.</p>
                    <div class="btn-group">
                        <button id="market-btn" class="btn">Market</button>
                        <button id="research-btn" class="btn secondary">Research</button>
                    </div>
                </div>

                <div class="events-panel">
                    <h2>Events & Notifications</h2>
                    <div id="events-container">
                        <div class="event"><div class="event-date">Loading...</div><div>Game initializing...</div></div>
                    </div>
                </div>

                <div class="tech-panel">
                    <h2>Researched Tech</h2>
                    <div id="tech-container"><p>None</p></div>
                </div>

                <div class="advisor-placeholder">
                    <h3>Farm Advisor</h3>
                    <p>Welcome! Click 'Start Regular Game' to begin.</p>
                </div>
            </div>
        </div>
    </div> <!-- End .container -->

    <!-- Modals remain outside the main layout -->
    <div id="help-modal" class="modal">
        <div class="modal-content">
            <span class="close">×</span>
            <h2>California Climate Farmer - Help</h2>
            <p>Manage your farm against climate change challenges.</p>
            <h3>Getting Started</h3>
            <ul><li>Click plot or use selectors/hotkeys.</li><li>Monitor resources & events.</li><li>Research tech to adapt.</li></ul>
            <h3>Controls</h3>
            <ul><li>Use speed slider.</li><li>Pause button.</li><li>Overlays change view.</li><li>Hotkeys listed on grid.</li></ul>
            <h3>Climate Events</h3>
            <p>Prepare for droughts, heatwaves, etc. Tech helps mitigate.</p>
        </div>
    </div>

    <div id="research-modal" class="modal">
        <div class="modal-content">
            <span class="close">×</span>
            <h2>Research & Technology</h2>
            <p>Invest in technologies to improve efficiency and resilience.</p>
            <div id="research-options"></div>
        </div>
    </div>

    <div id="market-modal" class="modal">
        <div class="modal-content">
            <span class="close">×</span>
            <h2>Market Prices & Information</h2>
            <div id="market-info"></div>
        </div>
    </div>

    <!-- Splash Screen -->
   <div id="splash-screen" class="splash-container">
        <div class="splash-content">
            <h1 class="splash-title">California Climate Farmer</h1>
            <p class="splash-description">Manage your farm and adapt to climate challenges.</p>
            <div class="splash-options">
                <button id="regular-game-btn" class="btn">Start Regular Game</button>
                <button id="tutorial-btn" class="btn secondary">Tutorial (Coming Soon)</button>
            </div>
            <!-- Removed test options from UI for simplicity -->
            <!-- <div id="test-options" class="test-options"> ... </div> -->
        </div>
    </div>

    <!-- Debug Panel (Optional but useful) -->
    <div id="debug-panel" class="debug-panel" style="display: none;"> <!-- Hide by default -->
        <h3>Debug Information</h3>
        <div id="debug-content"></div>
    </div>

    <!-- Inline Debug Logger Script -->
    <script>
    (function() { /* ... Keep inline debug logger code ... */ })();
    window.addEventListener('error', function(e) { /* ... Keep module error tracker ... */ });
    </script>

    <!-- Module Scripts - Order Matters -->
    <script type="module" src="scripts/splash-screen.js"></script>
    <script type="module" src="scripts/main.js"></script>
</body>
</html>
